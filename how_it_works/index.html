
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="PDF generation in Python with Jinja2 templates and client-side JS support">
      
      
      
        <link rel="canonical" href="https://zipreport.github.io/zipreport/how_it_works/">
      
      
        <link rel="prev" href="../install/">
      
      
        <link rel="next" href="../build_templates/">
      
      
      <link rel="icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.2.7">
    
    
      
        <title>How it works - ZipReport</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="amber">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#how-it-works" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ZipReport" class="md-header__button md-logo" aria-label="ZipReport" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ZipReport
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              How it works
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/zipreport/zipreport" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ZipReport" class="md-nav__button md-logo" aria-label="ZipReport" data-md-component="logo">
      
  <img src="../img/logo.png" alt="logo">

    </a>
    ZipReport
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zipreport/zipreport" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    How it works
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    How it works
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#report-files" class="md-nav__link">
    Report Files
  </a>
  
    <nav class="md-nav" aria-label="Report Files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supporting-symbolic-links-min-version-210" class="md-nav__link">
    Supporting symbolic links (min version: 2.1.0)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#report-file-format-zpt" class="md-nav__link">
    Report file format (zpt)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manifest-file-manifestjson" class="md-nav__link">
    Manifest file: manifest.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-placeholder-file-datajson" class="md-nav__link">
    Data placeholder file: data.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#main-template-file-indexhtml" class="md-nav__link">
    Main template file: index.html
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processors" class="md-nav__link">
    Processors
  </a>
  
    <nav class="md-nav" aria-label="Processors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#available-processors" class="md-nav__link">
    Available Processors
  </a>
  
    <nav class="md-nav" aria-label="Available Processors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#processor-interface" class="md-nav__link">
    Processor Interface
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-classes" class="md-nav__link">
    Helper Classes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zipreportprocessor" class="md-nav__link">
    ZipReportProcessor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-zipreport-helper" class="md-nav__link">
    Using ZipReport Helper
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mimeprocessor" class="md-nav__link">
    MimeProcessor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-mimeprocessor-helper" class="md-nav__link">
    Using MIMEProcessor Helper
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weasyprintprocessor" class="md-nav__link">
    WeasyPrintProcessor
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../build_templates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building Templates
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI tool: zipreport
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security considerations
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#report-files" class="md-nav__link">
    Report Files
  </a>
  
    <nav class="md-nav" aria-label="Report Files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supporting-symbolic-links-min-version-210" class="md-nav__link">
    Supporting symbolic links (min version: 2.1.0)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#report-file-format-zpt" class="md-nav__link">
    Report file format (zpt)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manifest-file-manifestjson" class="md-nav__link">
    Manifest file: manifest.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-placeholder-file-datajson" class="md-nav__link">
    Data placeholder file: data.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#main-template-file-indexhtml" class="md-nav__link">
    Main template file: index.html
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processors" class="md-nav__link">
    Processors
  </a>
  
    <nav class="md-nav" aria-label="Processors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#available-processors" class="md-nav__link">
    Available Processors
  </a>
  
    <nav class="md-nav" aria-label="Available Processors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#processor-interface" class="md-nav__link">
    Processor Interface
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-classes" class="md-nav__link">
    Helper Classes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zipreportprocessor" class="md-nav__link">
    ZipReportProcessor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-zipreport-helper" class="md-nav__link">
    Using ZipReport Helper
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mimeprocessor" class="md-nav__link">
    MimeProcessor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-mimeprocessor-helper" class="md-nav__link">
    Using MIMEProcessor Helper
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#weasyprintprocessor" class="md-nav__link">
    WeasyPrintProcessor
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="how-it-works">How it works<a class="headerlink" href="#how-it-works" title="Permanent link">&para;</a></h1>
<p>ZipReport relies on two core concepts: Report Files and Processors. The rendering is executed in two stages - first,
the result of rendering the Jinja template is generated and stored within the memory representation of the report file
with the name <em>report.html</em>. Then, the in-memory report file is passed to a Processor, to be rendered onto its final
form - either PDF or MIME message.
Content, such as dynamically generated images is also embedded on the in-memory report file. It is also possible to add
extra files at runtime, before passing it to the desired processor. However, replacement of existing files is not
allowed.</p>
<h2 id="report-files">Report Files<a class="headerlink" href="#report-files" title="Permanent link">&para;</a></h2>
<p>A report file is a Jinja template, a manifest file and an optional data file packed into a zip file, usually with .zpt
extension. These files can be easily generated with the zipreport cli tool. For more information on the cli tool, check
the <a href="../cli/">cli documentation</a></p>
<p>For a Jinja template to be packed into a report file (and be a valid report), it needs to contain a manifest. A manifest
is a JSON file called manifest.json, that contains basic report information, such as title and mandatory template
variables.
The template may also contain a data.json file, that will be used when debugging (zipreport debug) the template. This
file
provides placeholder data for the required fields, for previewing purposes.</p>
<p>The main Jinja template file must be named <strong>index.html</strong>. A template cannot contain a file called named <em>report.html</em>.
This
is a reserved name, used to store the result of the Jinja rendering. The template can also include other files, such as
partials, css resources, javascript resources, images or fonts.</p>
<p>Example of structure from examples/reports/simple:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>examples/reports/simple
.
├──<span class="w"> </span>css
│<span class="w">   </span>└──<span class="w"> </span>style.css
├──<span class="w"> </span>data.json
├──<span class="w"> </span>index.html
├──<span class="w"> </span>manifest.json
└──<span class="w"> </span>partials
<span class="w">    </span>└──<span class="w"> </span>base.html

<span class="m">2</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">5</span><span class="w"> </span>files
$
</code></pre></div>
<h3 id="supporting-symbolic-links-min-version-210">Supporting symbolic links (min version: 2.1.0)<a class="headerlink" href="#supporting-symbolic-links-min-version-210" title="Permanent link">&para;</a></h3>
<p>The template file tree is often a well-defined, contained structure. Starting with version 2.1.0, to allow eg. sharing
of resources between
templates, the usage of symbolic links is supported in both <em>zipreport debug</em> and <em>zipreport build</em>. By using <em>-s</em>, the
commands
will follow and process any related symlinks, as long as they are linked within the structure of the template.</p>
<h3 id="report-file-format-zpt">Report file format (zpt)<a class="headerlink" href="#report-file-format-zpt" title="Permanent link">&para;</a></h3>
<p>ZipReport report files (*.zpt) are just regular zip files with - at least - the following entries:</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Mandatory</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>index.html</td>
<td>yes</td>
<td>Report template main file</td>
</tr>
<tr>
<td>manifest.json</td>
<td>yes</td>
<td>Report manifest file. Contains report information such as title, description and mandatory parameters</td>
</tr>
<tr>
<td>data.json</td>
<td>no</td>
<td>Optional data file to be used when debugging the template</td>
</tr>
</tbody>
</table>
<p>For more details on these files, see below.</p>
<h3 id="manifest-file-manifestjson">Manifest file: manifest.json<a class="headerlink" href="#manifest-file-manifestjson" title="Permanent link">&para;</a></h3>
<p>The manifest.json is a regular JSON file. Its structure is as follows:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>author</td>
<td>string</td>
<td>Report author identification</td>
</tr>
<tr>
<td>title</td>
<td>string</td>
<td>Report title</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>Extended description</td>
</tr>
<tr>
<td>version</td>
<td>string</td>
<td>ZipReport engine version (currently ignored)</td>
</tr>
<tr>
<td>useJSEvent</td>
<td>string</td>
<td>If "true", will automatically use jsEvent with ZipReport =cli/server</td>
</tr>
<tr>
<td>params</td>
<td>list</td>
<td>List of mandatory parameter names. When rendering the report, will generate an exception if the passed parameter keys does not match this list</td>
</tr>
</tbody>
</table>
<p>Additionally, the manifest <strong>can</strong> contain other fields relevant to the application, they are just ignored by ZipReport.
If other fields exist, they can be accessed from the application on certain usage patterns.</p>
<p>Example of manifest.json from examples/reports/simple:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;author&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jpinheiro&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Simple Report&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Simple ZipReport Report&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;title&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;color_list&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;description&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>In this example, to render the report, it is necessary to pass a dict containing the keys specified in <em>params</em>. The
dict
may contain other keys. If the keys specified in the manifest are not present, rendering will generate a <em>RuntimeError</em>
exception.</p>
<h3 id="data-placeholder-file-datajson">Data placeholder file: data.json<a class="headerlink" href="#data-placeholder-file-datajson" title="Permanent link">&para;</a></h3>
<p>The data placeholder file is an optional JSON file named data.json. It contains a dictionary of predefined values for
the required params specified in the manifest file. This is used to aid the design and preview of the reports, during
development. It is ignored when used outside the scope of zipreport debug.</p>
<p>Example of data.json from examples/reports/simple, for the manifest in the previous example:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Simple report with Jinja templating&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;color_list&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;pink&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;green&quot;</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam ut ornare metus.&quot;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="main-template-file-indexhtml">Main template file: index.html<a class="headerlink" href="#main-template-file-indexhtml" title="Permanent link">&para;</a></h3>
<p>This is the Jinja template entrypoint for rendering. It can reference local resources residing below the template folder
in the filesystem hierarchy (meaning it is not possible to use partials from another template), or external resources
such
as javascript libraries, css frameworks or fonts.</p>
<p>Example of index.html from examples/reports/simple, using a partial (<em>partials/base.html</em>) as wel as some
Jinja template expressions:</p>
<div class="highlight"><pre><span></span><code>{% extends &#39;partials/base.html&#39; %}

{% block title%}
{{ title }}
{% endblock %}

{% block content %}
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{ title }} : main<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Some custom text:<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
    {{ description }}
<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>A list of colors:<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
    {% for item in color_list %}
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>Color: {{ item }}<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    {% endfor %}
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
{% endblock %}
</code></pre></div>
<h2 id="processors">Processors<a class="headerlink" href="#processors" title="Permanent link">&para;</a></h2>
<p>Processors are classes that implements <em>zipreport.processors.ProcessorInterface</em>.
Their role is to interact with a backend and generate a PDF file or a MIME message. The generation result is never an
actual file but a <em>io.BytesIO</em> buffer that can easily be stored to disk or streamed to a client.</p>
<p>Processors can be used directly or via convenient helper classes that wrap both Jinja rendering logic and processor
invocation.</p>
<h3 id="available-processors">Available Processors<a class="headerlink" href="#available-processors" title="Permanent link">&para;</a></h3>
<p>There are several available processors to interact with the different backend options. You can also easily create your
own, if necessary. Just implement a new class that implements  <em>zipreport.processors.ProcessorInterface</em>.</p>
<table>
<thead>
<tr>
<th>Class</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>zipreport.processors.ZipReportProcessor</td>
<td>zipreport-server API PDF report generation</td>
</tr>
<tr>
<td>zipreport.processors.MIMEProcessor</td>
<td>MIME email report generation</td>
</tr>
<tr>
<td>zipreport.processors.weasyprint.WeasyPrintProcessor</td>
<td>WeasyPrint PDF report generation</td>
</tr>
</tbody>
</table>
<h4 id="processor-interface">Processor Interface<a class="headerlink" href="#processor-interface" title="Permanent link">&para;</a></h4>
<p><em>zipreport.processors.ProcessorInterface</em> specifies a single method:</p>
<div class="highlight"><pre><span></span><code><span class="n">ProcessorInterface</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job</span><span class="p">:</span> <span class="n">ReportJob</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JobResult</span><span class="p">:</span>
</code></pre></div>
<p>This method receives a <em>zipreport.report.ReportJob</em> object. This object contains
all PDF-related options such as margins and page size, as well as the required ReportFile.
It returns a <em>zipreport.report.JobResult</em> object, with the status of the operation,
error information (if any), and the result buffer.</p>
<h4 id="helper-classes">Helper Classes<a class="headerlink" href="#helper-classes" title="Permanent link">&para;</a></h4>
<p>Helper classes encapsulate both the processor logic and the Jinja rendering logic. The following helper classes are
available:</p>
<table>
<thead>
<tr>
<th>Class</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>zipreport.ZipReport</td>
<td>ZipReportProcessor helper</td>
</tr>
<tr>
<td>zipreport.MIMEReport</td>
<td>MIMEProcessor helper</td>
</tr>
</tbody>
</table>
<p>See below for usage examples for each processor.</p>
<h4 id="zipreportprocessor">ZipReportProcessor<a class="headerlink" href="#zipreportprocessor" title="Permanent link">&para;</a></h4>
<p><em>ZipReportProcessor</em> interacts with the zipreport-server API to generate a PDF. From a development perspective, all
required
operations are done in-memory and no local storage is needed.</p>
<p>Constructor:</p>
<div class="highlight"><pre><span></span><code><span class="n">ZipReportProcessor</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">ZipReportClient</span><span class="p">)</span>
</code></pre></div>
<p><em>client</em> is an instance of <em>zipreport.processors.ZipReportClient</em>, whose function is to encapsulate API communication
logic.</p>
<p>ZipReportProcessor example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">zipreport.processors</span> <span class="kn">import</span> <span class="n">ZipReportProcessor</span><span class="p">,</span> <span class="n">ZipReportClient</span>
<span class="kn">from</span> <span class="nn">zipreport.report</span> <span class="kn">import</span> <span class="n">ReportFileLoader</span><span class="p">,</span> <span class="n">ReportJob</span>
<span class="kn">from</span> <span class="nn">zipreport.template</span> <span class="kn">import</span> <span class="n">JinjaRender</span>

<span class="c1"># output file</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="s2">&quot;result.pdf&quot;</span>

<span class="c1"># template variables</span>
<span class="n">report_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s2">&quot;Example report using Jinja templating&quot;</span><span class="p">,</span>
    <span class="s1">&#39;color_list&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">],</span>
    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;a long text field with some filler description&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># load report from file</span>
<span class="n">zpt</span> <span class="o">=</span> <span class="n">ReportFileLoader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;simple.zpt&quot;</span><span class="p">)</span>

<span class="c1"># initialize api client</span>
<span class="n">api_client</span> <span class="o">=</span> <span class="n">ZipReportClient</span><span class="p">(</span><span class="s2">&quot;https://127.0.0.1:6543&quot;</span><span class="p">,</span> <span class="s2">&quot;secretKey&quot;</span><span class="p">)</span>

<span class="c1"># first step:</span>
<span class="c1"># render the template using the report_data dict</span>
<span class="c1"># the result of the rendering is stored in-memory within the zpt file, with the name</span>
<span class="c1"># report.html</span>
<span class="n">JinjaRender</span><span class="p">(</span><span class="n">zpt</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">report_data</span><span class="p">)</span>

<span class="c1"># create a rendering job from the zpt file</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">ReportJob</span><span class="p">(</span><span class="n">zpt</span><span class="p">)</span>

<span class="c1"># second step:</span>
<span class="c1"># generate a PDF by calling the processor, using the API client</span>
<span class="c1"># this method returns a JobResult</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">ZipReportProcessor</span><span class="p">(</span><span class="n">api_client</span><span class="p">)</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>

<span class="c1"># if PDF generation was successful, save to file</span>
<span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">rpt</span><span class="p">:</span>
        <span class="n">rpt</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></div>
<h4 id="using-zipreport-helper">Using ZipReport Helper<a class="headerlink" href="#using-zipreport-helper" title="Permanent link">&para;</a></h4>
<p>ZipReportProcessor can also be used in a simplified fashion, by using the helper class <em>ZipReport</em>.
This class will create an API client, as well as a default <em>ReportJob</em>, simplifying the code implementation.</p>
<p>Constructor:</p>
<div class="highlight"><pre><span></span><code><span class="n">ZipReport</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">api_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">api_version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">secure_ssl</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<p><em>url</em> is the API endpoint url, <em>api_key</em> is the API authentication token, and <em>secure_ssl</em> enables or disables full
certificate
chain verification on SSL certificates for HTTPS endpoints. <em>api_version</em> specifies the API version to connect;
currently,
only v2 is implemented.</p>
<p>Code example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">zipreport</span> <span class="kn">import</span> <span class="n">ZipReport</span>
<span class="kn">from</span> <span class="nn">zipreport.report</span> <span class="kn">import</span> <span class="n">ReportFileLoader</span>

<span class="c1"># output file</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="s2">&quot;result.pdf&quot;</span>

<span class="c1"># template variables</span>
<span class="n">report_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s2">&quot;Example report using Jinja templating&quot;</span><span class="p">,</span>
    <span class="s1">&#39;color_list&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">],</span>
    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;a long text field with some filler description&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># load report from file</span>
<span class="n">zpt</span> <span class="o">=</span> <span class="n">ReportFileLoader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;reports/simple.zpt&quot;</span><span class="p">)</span>

<span class="c1"># render the report using ZipReport helper class</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">ZipReport</span><span class="p">(</span><span class="s2">&quot;https://127.0.0.1:6543&quot;</span><span class="p">,</span> <span class="s2">&quot;someSecret&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">render_defaults</span><span class="p">(</span><span class="n">zpt</span><span class="p">,</span> <span class="n">report_data</span><span class="p">)</span>

<span class="c1"># if PDF generation was successful, save file</span>
<span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">rpt</span><span class="p">:</span>
        <span class="n">rpt</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></div>
<h4 id="mimeprocessor">MimeProcessor<a class="headerlink" href="#mimeprocessor" title="Permanent link">&para;</a></h4>
<p><em>MIMEProcessor</em> generates a multipart MIME email message with all local resources embedded. It requires no local
storage.</p>
<p>Constructor:</p>
<div class="highlight"><pre><span></span><code><span class="n">MIMEProcessor</span><span class="p">()</span>
</code></pre></div>
<p>MIMEProcessor example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">zipreport.processors</span> <span class="kn">import</span> <span class="n">MIMEProcessor</span>
<span class="kn">from</span> <span class="nn">zipreport.report</span> <span class="kn">import</span> <span class="n">ReportFileLoader</span><span class="p">,</span> <span class="n">ReportJob</span>
<span class="kn">from</span> <span class="nn">zipreport.template</span> <span class="kn">import</span> <span class="n">JinjaRender</span>

<span class="c1"># output file</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="s2">&quot;result.eml&quot;</span>

<span class="c1"># template variables</span>
<span class="n">report_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s2">&quot;Example report using Jinja templating&quot;</span><span class="p">,</span>
    <span class="s1">&#39;color_list&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">],</span>
    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;a long text field with some filler description&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># load report from file</span>
<span class="n">zpt</span> <span class="o">=</span> <span class="n">ReportFileLoader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;simple.zpt&quot;</span><span class="p">)</span>

<span class="c1"># first step:</span>
<span class="c1"># render the template using the report_data dict</span>
<span class="c1"># the result of the rendering is stored in-memory within the zpt file, with the name</span>
<span class="c1"># report.html</span>
<span class="n">JinjaRender</span><span class="p">(</span><span class="n">zpt</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">report_data</span><span class="p">)</span>

<span class="c1"># create a rendering job from the zpt file</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">ReportJob</span><span class="p">(</span><span class="n">zpt</span><span class="p">)</span>

<span class="c1"># second step:</span>
<span class="c1"># generate a MIME message by calling the processor</span>
<span class="c1"># this method returns a JobResult</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">MIMEProcessor</span><span class="p">()</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>

<span class="c1"># if message generation was successful, save to file</span>
<span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">rpt</span><span class="p">:</span>
        <span class="c1"># result.report is of type EmailMessage, not io.BytesIO</span>
        <span class="n">rpt</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">as_bytes</span><span class="p">())</span>
</code></pre></div>
<h4 id="using-mimeprocessor-helper">Using MIMEProcessor Helper<a class="headerlink" href="#using-mimeprocessor-helper" title="Permanent link">&para;</a></h4>
<p>MIMEProcessor can also be used in a simplified fashion, by using the helper class <em>MIMEReport</em>.
This class will create a default <em>ReportJob&lt;zipreport.reports.job.ReportJob</em>, simplifying the PDF generation process.</p>
<p>Constructor:</p>
<div class="highlight"><pre><span></span><code><span class="n">MIMEReport</span><span class="p">()</span>
</code></pre></div>
<p>Code example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">zipreport</span> <span class="kn">import</span> <span class="n">MIMEReport</span>
<span class="kn">from</span> <span class="nn">zipreport.report</span> <span class="kn">import</span> <span class="n">ReportFileLoader</span>

<span class="c1"># output file</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="s2">&quot;result.eml&quot;</span>

<span class="c1"># template variables</span>
<span class="n">report_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s2">&quot;Example report using Jinja templating&quot;</span><span class="p">,</span>
    <span class="s1">&#39;color_list&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">],</span>
    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;a long text field with some filler description&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># load report from file</span>
<span class="n">zpt</span> <span class="o">=</span> <span class="n">ReportFileLoader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;reports/simple.zpt&quot;</span><span class="p">)</span>

<span class="c1"># render the report with default job options, using the helper class</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">MIMEReport</span><span class="p">()</span><span class="o">.</span><span class="n">render_defaults</span><span class="p">(</span><span class="n">zpt</span><span class="p">,</span> <span class="n">report_data</span><span class="p">)</span>

<span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">rpt</span><span class="p">:</span>
        <span class="c1"># result.report is of type EmailMessage, not io.BytesIO</span>
        <span class="n">rpt</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">as_bytes</span><span class="p">())</span>
</code></pre></div>
<h4 id="weasyprintprocessor">WeasyPrintProcessor<a class="headerlink" href="#weasyprintprocessor" title="Permanent link">&para;</a></h4>
<p><em>WeasyPrintProcessor</em> relies on WeasyPrint for PDF generation.
By using WeasyPrint, client-side Javascript is not supported, and CSS support is limited. Check WeasyPrint website for
more
details. Details on how to install ZipReport with WeasyPrint support can be found in
the <a href="../install/">installation instructions</a>.</p>
<p>Constructor:</p>
<div class="highlight"><pre><span></span><code><span class="n">WeasyPrintProcessor</span><span class="p">()</span>
</code></pre></div>
<p>The WeasyPrintProcessor includes some additional methods to map WeasyPrint basic requirements to ZipReport processor
logic:</p>
<div class="highlight"><pre><span></span><code><span class="n">WeasyPrintProcessor</span><span class="o">.</span><span class="n">add_css</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">css</span><span class="p">)</span>
</code></pre></div>
<p>where <em>css</em> is a WeasyPrint CSS object; see example below</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">zipreport.processors.weasyprint</span> <span class="kn">import</span> <span class="n">WeasyPrintProcessor</span>
<span class="kn">from</span> <span class="nn">weasyprint</span> <span class="kn">import</span> <span class="n">CSS</span>

<span class="n">processor</span> <span class="o">=</span> <span class="n">WeasyPrintProcessor</span><span class="p">()</span>
<span class="n">processor</span><span class="o">.</span><span class="n">add_css</span><span class="p">(</span><span class="n">CSS</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s1">&#39;body { font-family: serif !important }&#39;</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">WeasyPrintProcessor</span><span class="o">.</span><span class="n">set_font_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">font_config</span><span class="p">)</span>
</code></pre></div>
<p><em>font_config</em> is a FontConfiguration() object. See WeasyPrint documentation for more details</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">zipreport.processors.weasyprint</span> <span class="kn">import</span> <span class="n">WeasyPrintProcessor</span>
<span class="kn">from</span> <span class="nn">weasyprint</span> <span class="kn">import</span> <span class="n">CSS</span>
<span class="kn">from</span> <span class="nn">weasyprint.fonts</span> <span class="kn">import</span> <span class="n">FontConfiguration</span>

<span class="n">processor</span> <span class="o">=</span> <span class="n">WeasyPrintProcessor</span><span class="p">()</span>
<span class="n">font_config</span> <span class="o">=</span> <span class="n">FontConfiguration</span><span class="p">()</span>
<span class="c1"># taken from WeasyPrint tutorial in https://weasyprint.readthedocs.io/en/stable/tutorial.html</span>
<span class="n">css</span> <span class="o">=</span> <span class="n">CSS</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">@font-face {</span>
<span class="s1">    font-family: Gentium;</span>
<span class="s1">    src: url(http://example.com/fonts/Gentium.otf);</span>
<span class="s1">}</span>
<span class="s1">h1 { font-family: Gentium }&#39;&#39;&#39;</span><span class="p">,</span> <span class="n">font_config</span><span class="o">=</span><span class="n">font_config</span><span class="p">)</span>
<span class="n">processor</span><span class="o">.</span><span class="n">add_css</span><span class="p">(</span><span class="n">css</span><span class="p">)</span>
<span class="n">processor</span><span class="o">.</span><span class="n">set_font_config</span><span class="p">(</span><span class="n">font_config</span><span class="p">)</span>
</code></pre></div>
<p>WeasyPrintProcessor example:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">zipreport.processors.weasyprint</span> <span class="kn">import</span> <span class="n">WeasyPrintProcessor</span>
<span class="kn">from</span> <span class="nn">zipreport.report</span> <span class="kn">import</span> <span class="n">ReportFileLoader</span><span class="p">,</span> <span class="n">ReportJob</span>
<span class="kn">from</span> <span class="nn">zipreport.template</span> <span class="kn">import</span> <span class="n">JinjaRender</span>

<span class="c1"># output file</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="s2">&quot;result.pdf&quot;</span>

<span class="c1"># template variables</span>
<span class="n">report_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s2">&quot;Example report using Jinja templating&quot;</span><span class="p">,</span>
    <span class="s1">&#39;color_list&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">],</span>
    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;a long text field with some filler description&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># load report from file</span>
<span class="n">zpt</span> <span class="o">=</span> <span class="n">ReportFileLoader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;simple.zpt&quot;</span><span class="p">)</span>

<span class="c1"># first step:</span>
<span class="c1"># render the template using the report_data dict</span>
<span class="c1"># the result of the rendering is stored in-memory within the zpt file, with the name</span>
<span class="c1"># report.html</span>
<span class="n">JinjaRender</span><span class="p">(</span><span class="n">zpt</span><span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">report_data</span><span class="p">)</span>

<span class="c1"># create a rendering job from the zpt file</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">ReportJob</span><span class="p">(</span><span class="n">zpt</span><span class="p">)</span>

<span class="c1"># second step:</span>
<span class="c1"># generate a PDF by calling the processor, using the API client</span>
<span class="c1"># this method returns a JobResult</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">WeasyPrintProcessor</span><span class="p">()</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>

<span class="c1"># if PDF generation was successful, save to file</span>
<span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">rpt</span><span class="p">:</span>
        <span class="n">rpt</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">report</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></div>
<p><strong>Note:</strong> This processor does not have a helper class, to avoid having WeasyPrint as a required ZipReport dependency.</p>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/zipreport/zipreport" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["search.suggest", "search.highlight", "content.tabs.link"], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>